(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tab2/baoxiuadd"],{"0563":function(e,t,n){"use strict";n.r(t);var r=n("6dfc"),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=o.a},"1f16":function(e,t,n){},"2ea3":function(e,t,n){"use strict";var r=n("1f16"),o=n.n(r);o.a},"6dfc":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n("f227");function o(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}function i(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a={data:function(){return{form:{id:"",crane_id:"",qzjLabel:"",mechanism:"",ssjgLabel:"",gzh:"",product_type:"",report_person:"",report_tel:"",report_time:"",bug_description:"",report_img:[]},fileList:[],action:r.BASE_URL+"Image/PostUpload",show:{qzjInput:!1,ssjgInput:!1,jgButton:!0},typeList:[],submitButtonDis:!1,qzjSelectShow:!1,ssjgSelectShow:!1,qzjList:[],ssjgList:[],rules:{qzjLabel:[{required:!0,message:"请输入具体内容",trigger:"blur"}],ssjgLabel:[{required:!0,message:"请输入具体内容",trigger:"blur"}],report_tel:[{required:!0,message:"请输入具体内容",trigger:"blur"}],report_person:[{required:!0,message:"请输入具体内容",trigger:"blur"}]}}},computed:{},methods:{tagSelect:function(e){var t,n=o(this.typeList);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.name===e){r.mode="plain"===r.mode?"dark":"plain";break}}}catch(i){n.e(i)}finally{n.f()}},removeImg:function(e,t){console.log(t),this.form.report_img=[];var n,r=o(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.form.report_img.push(i.response.url)}}catch(s){r.e(s)}finally{r.f()}},uploadSuccess:function(e){this.form.report_img.push(e.url)},changeQzjShow:function(){this.show.qzjInput=!this.show.qzjInput,this.form.qzjLabel="",this.form.crane_id=-1,this.changeSsjgShow(),this.show.qzjInput?(this.show.jgButton=!1,this.show.ssjgInput=!0):this.show.jgButton=!0},changeSsjgShow:function(){this.show.ssjgInput=!this.show.ssjgInput,this.form.ssjgLabel="",this.form.mechanism=-1},getProductType:function(){var e=this,t={pageIndex:1,pageSize:20,pid:"all",name:"产品类型"};this.$myHttp("Dict/SelectSysDictType",t).then((function(t){if(0!==t.Total){var n={pageIndex:1,pageSize:1e3,dict_id:t.Data[0].ID};e.$myHttp("Dict/SelectSysDictTree",n).then((function(t){e.typeList=[];var n,r=o(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.typeList.push({name:i.name,mode:"plain"})}}catch(s){r.e(s)}finally{r.f()}console.log(222),e.initData()}))}}))},submitData:function(){var t,n=this,r=[],i=o(this.typeList);try{for(i.s();!(t=i.n()).done;){var s=t.value;"dark"===s.mode&&r.push(s.name)}}catch(a){i.e(a)}finally{i.f()}console.log(r),0!==r.length?(this.form.product_type=r.length>0?JSON.stringify(r):"",this.$refs.uForm.validate((function(t){if(t){n.submitButtonDis=!0;var r={OrderID:n.form.id,CraneID:n.form.crane_id,CraneName:n.form.qzjLabel,MechanismID:n.form.mechanism,MechanismName:n.form.ssjgLabel,ProjectNumber:n.form.gzh,ProductType:n.form.product_type,Describe:n.form.bug_description,ContactPerson:n.form.report_person,ContactNumber:n.form.report_tel,PictureAddress:JSON.stringify(n.form.report_img),CompanyID:e.getStorageSync("comanyId")},o={info:JSON.stringify(r),type:1},i="Order/AddOrder",s="新增成功";n.form.id&&(o.type=5,i="Order/UpdateOrder",s="更新成功"),n.$myHttp(i,o).then((function(t){n.$refs.uToast.show({title:s,type:"success"}),setTimeout((function(){n.submitButtonDis=!1,e.navigateBack()}),600)}))}}))):this.$refs.uToast.show({title:"请选择产品类型",type:"error"})},qzjSelectChange:function(e){this.form.crane_id=e[0].value,this.form.qzjLabel=e[0].label,this.getJgList()},ssjgSelectChange:function(e){this.form.mechanism=e[0].value,this.form.ssjgLabel=e[0].label},getQzjList:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r={SessionId:e.getStorageSync("password")};this.$myHttp("WaterData/CraneInfo",r).then((function(e){if(e.cranes){var r=e.cranes;t.qzjList=[];var i,s=o(r);try{for(s.s();!(i=s.n()).done;){var a=i.value;t.qzjList.push({value:a.ID,label:a.起重机名称})}}catch(u){s.e(u)}finally{s.f()}n||(t.form.crane_id=t.qzjList[0].value,t.form.qzjLabel=t.qzjList[0].label),t.getJgList(n)}}))},initData:function(){var t=this;if(this.form.id){var n={OrderID:this.form.id,pageSize:1,pageIndex:1};this.$myHttp("Order/SelectOrder",n).then((function(e){console.log(455),console.log(e),t.form.crane_id=e.CraneID,t.form.qzjLabel=e.CraneName,t.form.mechanism=e.MechanismID,t.form.ssjgLabel=e.MechanismName,t.form.gzh=e.ProjectNumber,t.form.product_type=e.ProductType,t.form.bug_description=e.Describe,t.form.report_person=e.ContactPerson,t.form.report_tel=e.ContactNumber;var n,i=JSON.parse(t.form.product_type),s=o(t.typeList);try{for(s.s();!(n=s.n()).done;){var a,u=n.value,c=o(i);try{for(c.s();!(a=c.n()).done;){var l=a.value;u.name===l&&(u.mode="dark")}}catch(h){c.e(h)}finally{c.f()}}}catch(h){s.e(h)}finally{s.f()}t.form.report_img=JSON.parse(e.PictureAddress||"[]"),t.fileList=[];var f,m=o(t.form.report_img);try{for(m.s();!(f=m.n()).done;){var d=f.value;t.fileList.push({url:r.BASE_URL+"/Image/GetImage?image="+d})}}catch(h){m.e(h)}finally{m.f()}t.getQzjList(!0)}))}else this.form.report_person=e.getStorageSync("yonghu"),this.form.report_tel=e.getStorageSync("tel")+"",this.getQzjList(!1)},getJgList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n={cid:this.form.crane_id,Tags:JSON.stringify(["mechanism"]),toLevel:2,cal:0};this.ssjgList=[],this.$myHttp("AgentTree/GetNodesByTag",n).then((function(n){if(0===n.length)return e.show.ssjgInput=!0,e.form.mechanism=-1,e.form.ssjgLabel="",void(e.show.jgButton=!1);e.show.ssjgInput=!1,e.show.jgButton=!0;var r,i=o(n);try{for(i.s();!(r=i.n()).done;){var s=r.value;e.ssjgList.push({value:s.ID,label:s.NodeConfig.ShowName})}}catch(a){i.e(a)}finally{i.f()}t||(e.form.mechanism=e.ssjgList[0].value,e.form.ssjgLabel=e.ssjgList[0].label)}))}},onReady:function(){this.$refs.uForm.setRules(this.rules)},onShow:function(){},onLoad:function(e){console.log(111),console.log(e),this.form.id=e.id,this.getProductType()}};t.default=a}).call(this,n("543d")["default"])},"782b":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r}));var r={uForm:function(){return n.e("uview-ui/components/u-form/u-form").then(n.bind(null,"cfff"))},uFormItem:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-form-item/u-form-item")]).then(n.bind(null,"d721"))},uInput:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-input/u-input")]).then(n.bind(null,"c466"))},uButton:function(){return n.e("uview-ui/components/u-button/u-button").then(n.bind(null,"f1cc"))},uTag:function(){return n.e("uview-ui/components/u-tag/u-tag").then(n.bind(null,"27b2"))},uUpload:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-upload/u-upload")]).then(n.bind(null,"d1c0"))},uSelect:function(){return n.e("uview-ui/components/u-select/u-select").then(n.bind(null,"7e82"))},uToast:function(){return n.e("uview-ui/components/u-toast/u-toast").then(n.bind(null,"dbb4"))}},o=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.qzjSelectShow=!0},e.e1=function(t){e.ssjgSelectShow=!0})},i=[]},9094:function(e,t,n){"use strict";(function(e){n("52a8");r(n("66fd"));var t=r(n("9ec8"));function r(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},"9ec8":function(e,t,n){"use strict";n.r(t);var r=n("782b"),o=n("0563");for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);n("2ea3");var s,a=n("f0c5"),u=Object(a["a"])(o["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],s);t["default"]=u.exports}},[["9094","common/runtime","common/vendor"]]]);