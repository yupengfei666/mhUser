(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tab1/agent"],{5737:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,a=s(n("6bdd")),o=n("dad2"),r=n("26cb");function s(t){return t&&t.__esModule?t:{default:t}}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=null,f={data:function(){return{height:0,categroy:"",categoryActive:0,scrollTop:0,scrollHeight:0,timer:null,fenlei:[],system:"",agentList:[],zonglan:{day:0,month:0,standard:0},filterAgentList:{},cWidth:"",cHeight:"",pixelRatio:1,textarea:"",guolvtiaojian:""}},computed:(0,r.mapState)(["forcedLogin","url"]),methods:l(l({},(0,r.mapMutations)(["login","logout","setStorage"])),{},{Clearguolvtiaojian:function(){this.guolvtiaojian=""},getServerData:function(){t.request({url:this.url+"WeChat/GetDeviceMonthAlarmInfo",data:{DeviceID:this.system},header:{"content-type":"application/json",sessionkey:t.getStorageSync("password")},success:function(e){401===e.statusCode&&t.reLaunch({url:"../tab4/login"});for(var n={categories:[],series:[{name:"严重故障",data:[]}]},a=0;a<e.data.length;a++)n.categories.push(e.data[a]["时间"]),n.series[0].data.push(e.data[a]["数量"]);i.textarea=JSON.stringify(n),i.showLineA("canvasLineA",n)},fail:function(){i.tips="网络错误，小程序端请检查合法域名"}})},showLineA:function(t,e){g=new a.default({$this:i,canvasId:t,type:"line",fontSize:11,padding:[15,15,0,15],legend:{show:!0,padding:5,lineHeight:11,margin:5},dataLabel:!0,dataPointShape:!0,background:"#FFFFFF",pixelRatio:i.pixelRatio,categories:e.categories,series:e.series,animation:!0,enableScroll:!0,xAxis:{disableGrid:!1,type:"grid",gridType:"dash",itemCount:4,scrollShow:!0,scrollAlign:"left"},yAxis:{gridType:"dash",splitNumber:8,min:10,max:180,format:function(t){return t.toFixed(0)}},width:i.cWidth*i.pixelRatio,height:i.cHeight*i.pixelRatio,extra:{line:{type:"straight"}}})},touchLineA:function(t){g.scrollStart(t)},moveLineA:function(t){g.scroll(t)},touchEndLineA:function(t){g.scrollEnd(t),g.touchLegend(t),g.showToolTip(t,{format:function(t,e){return e+" "+t.name+":"+t.data}})},changeData:function(){if((0,o.isJSON)(i.textarea)){var e=JSON.parse(i.textarea);g.updateData({series:e.series,categories:e.categories,scrollPosition:"right",animation:!1})}else t.showToast({title:"数据格式错误",image:"../../../static/images/alert-warning.png"})},getAppAgent:function(){var e=this;t.request({url:this.url+"WeChat/GetNowAgent",data:{DeviceID:this.system},method:"GET",dataType:"json",header:{"content-type":"application/json",sessionkey:t.getStorageSync("password")},success:function(n){if(t.hideToast(),200!==n.statusCode)console.log("请求失败:",n),401===n.statusCode&&t.reLaunch({url:"../tab4/login"});else{e.fenlei=[],e.agentList=n.data,console.log(1),console.log(e.agentList);for(var i=0;i<e.agentList.length;i++){for(var a=!0,o=0;o<e.fenlei.length;o++)if(e.fenlei[o].Classify==e.agentList[i].机构){a=!1;break}a&&e.fenlei.push({Type:"",Classify:e.agentList[i].机构})}e.fenlei.length>0&&e.categoryClickMain(e.fenlei[e.categoryActive],e.categoryActive)}},fail:function(){t.hideToast(),t.showToast({icon:"none",title:"网络连接失败"})}})},getZongLan:function(){var e=this;t.request({url:this.url+"WeChat/DeviceAlarm",data:{DeviceID:this.system},method:"GET",dataType:"json",header:{"content-type":"application/json",sessionkey:t.getStorageSync("password")},success:function(n){200!==n.statusCode?(console.log("请求失败:",n),401===n.statusCode&&t.reLaunch({url:"../tab4/login"})):e.zonglan=n.data},fail:function(){t.showToast({icon:"none",title:"网络连接失败"})}})},refreshAppAgent:function(){var e=this;t.showToast({title:"加载中...",icon:"loading",duration:3e4}),this.getAppAgent(),this.timer=setInterval((function(){e.getAppAgent()}),1e4)},clearTimer:function(){clearInterval(this.timer),this.timer=null},scroll:function(t){this.scrollHeight=t.detail.scrollHeight},categoryClickMain:function(t,e){this.categoryActive=e,this.categroy=t,this.filterAgentList={};for(var n=0;n<this.agentList.length;n++)this.agentList[n].机构==t.Classify&&(this.filterAgentList=this.agentList[n].data?this.agentList[n].data:[]);this.scrollTop=-this.scrollHeight*e}}),onLoad:function(e){i=this,this.cWidth=t.upx2px(600),this.cHeight=t.upx2px(500),this.height=t.getSystemInfoSync().windowHeight,this.system=JSON.parse(e.system).起重机ID,t.setNavigationBarTitle({title:JSON.parse(e.system).Name+"_实时状态"}),this.refreshAppAgent()},onUnload:function(){this.timer&&this.clearTimer()}};e.default=f}).call(this,n("543d")["default"])},"8129c":function(t,e,n){"use strict";n.r(e);var i=n("e674"),a=n("cce7");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("9167");var r,s=n("f0c5"),c=Object(s["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],r);e["default"]=c.exports},9167:function(t,e,n){"use strict";var i=n("f332"),a=n.n(i);a.a},c50a:function(t,e,n){"use strict";(function(t){n("52a8");i(n("66fd"));var e=i(n("8129c"));function i(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},cce7:function(t,e,n){"use strict";n.r(e);var i=n("5737"),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a},e674:function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}));var a=function(){var t=this,e=t.$createElement,n=(t._self._c,0!==t.filterAgentList.length?t.__map(t.filterAgentList.AgentData,(function(e,n){var i=t.__get_orig(e),a=e.agentName.indexOf(t.guolvtiaojian);return{$orig:i,g0:a}})):null);t.$mp.data=Object.assign({},{$root:{l0:n}})},o=[]},f332:function(t,e,n){}},[["c50a","common/runtime","common/vendor"]]]);