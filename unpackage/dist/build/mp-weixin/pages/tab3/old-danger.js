(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tab3/old-danger"],{"0076":function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement;e._self._c},s=[]},"42a0":function(e,t,a){"use strict";a.r(t);var n=a("fbf2"),i=a.n(n);for(var s in n)"default"!==s&&function(e){a.d(t,e,(function(){return n[e]}))}(s);t["default"]=i.a},"6d0c":function(e,t,a){"use strict";(function(e){a("52a8");n(a("66fd"));var t=n(a("97a7"));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=a,e(t.default)}).call(this,a("543d")["createPage"])},"97a7":function(e,t,a){"use strict";a.r(t);var n=a("0076"),i=a("42a0");for(var s in i)"default"!==s&&function(e){a.d(t,e,(function(){return i[e]}))}(s);a("aa32");var o,r=a("f0c5"),c=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],o);t["default"]=c.exports},aa32:function(e,t,a){"use strict";var n=a("bed5"),i=a.n(n);i.a},bed5:function(e,t,a){},fbf2:function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(a("6bdd")),s=a("dad2"),o=a("26cb");function r(e){return e&&e.__esModule?e:{default:e}}var c=null,l={data:function(){return{selectAgentlength:0,beginDate:"",endDate:"",cheName:"",classify:"",pageCount:10,pages:1,selectAgent:[],oldAgentList:[],systemCheck:[],loadMoreText:"加载中...",showLoadMore:!1,cWidth:"",cHeight:"",pixelRatio:1,textarea:""}},computed:(0,o.mapState)(["url"]),methods:{getChartData:function(){e.request({url:this.url+"Danger/GetNearDangerInfo",data:{CraneID:this.cheName,begin:this.beginDate,end:this.endDate,type:"0"},header:{"content-type":"application/json",sessionkey:e.getStorageSync("password")},success:function(t){401===t.statusCode&&e.reLaunch({url:"../tab4/login"});for(var a={categories:[],series:[{name:"行为隐患",data:[]}]},i=0;i<t.data.length;i++)a.categories.push(t.data[i]["时间"].substring(5,10)),a.series[0].data.push(t.data[i]["数量"]);n.textarea=JSON.stringify(a),n.showLineA("canvasLineA",a)},fail:function(){n.tips="网络错误，小程序端请检查合法域名"}})},showLineA:function(e,t){c=new i.default({$this:n,canvasId:e,type:"line",fontSize:11,padding:[15,15,0,15],legend:{show:!0,padding:5,lineHeight:11,margin:5},dataLabel:!0,dataPointShape:!0,background:"#FFFFFF",pixelRatio:n.pixelRatio,categories:t.categories,series:t.series,animation:!0,enableScroll:!0,xAxis:{disableGrid:!1,type:"grid",gridType:"dash",itemCount:8,scrollShow:!0,scrollAlign:"left"},yAxis:{gridType:"dash",splitNumber:8,min:10,max:200,format:function(e){return e.toFixed(0)}},width:n.cWidth*n.pixelRatio,height:n.cHeight*n.pixelRatio,extra:{line:{type:"straight"}}})},touchLineA:function(e){c.scrollStart(e)},moveLineA:function(e){c.scroll(e)},touchEndLineA:function(e){c.scrollEnd(e),c.touchLegend(e),c.showToolTip(e,{format:function(e,t){return t+" "+e.name+":"+e.data}})},changeData:function(){if((0,s.isJSON)(n.textarea)){var t=JSON.parse(n.textarea);c.updateData({series:t.series,categories:t.categories,scrollPosition:"right",animation:!1})}else e.showToast({title:"数据格式错误",image:"../../../static/images/alert-warning.png"})},cheAgent:function(){e.navigateTo({url:"./zhuangtaiquxian"})},getAppOldAgent:function(){var t=this;this.showLoadMore=!0;var a="";"行为隐患"===this.classify?a="Danger/GetHisActionDangers":"设备隐患"===this.classify&&(a="Danger/GetHisDeviceDangers"),e.showToast({title:"加载中...",icon:"loading",duration:3e4}),e.request({url:this.url+a,method:"GET",dataType:"json",header:{"content-type":"application/json",sessionkey:e.getStorageSync("password")},data:{begin:this.beginDate,end:this.endDate,CID:this.cheName,type:"0",pagesize:this.pageCount,pageindex:this.pages},success:function(a){if(e.stopPullDownRefresh(),e.hideToast(),200!==a.statusCode)console.log("请求失败:",a),401===a.statusCode&&e.reLaunch({url:"../tab4/login"});else{for(var n=0;n<a.data.Data.length;n++)t.selectAgent.push(a.data.Data[n]);a.data.Data.length<10&&(t.loadMoreText="没有更多数据了!"),t.selectAgentlength=t.selectAgent.length,console.log(JSON.stringify(t.selectAgent))}},fail:function(){e.stopPullDownRefresh(),e.hideToast(),e.showToast({icon:"none",title:"网络连接失败"})}})}},onPullDownRefresh:function(){this.loadMoreText="加载中...",this.showLoadMore=!1,this.selectAgent=[],this.pages=1,this.getAppOldAgent()},onReachBottom:function(){this.pages=this.pages+1,this.getAppOldAgent()},onLoad:function(t){n=this,this.cWidth=e.upx2px(750),this.cHeight=e.upx2px(500),this.beginDate=t.beginDate,this.endDate=t.endDate,this.cheName=t.cheName,this.classify=t.classify,e.setNavigationBarTitle({title:t.name+"_"+t.classify}),this.getAppOldAgent(),this.getChartData()}};t.default=l}).call(this,a("543d")["default"])}},[["6d0c","common/runtime","common/vendor"]]]);